<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wings of the Cherubim ‚Äì Outreach Hub</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #0b0c10;
      color: #f4f4f4;
    }
    header {
      background: #1f2833;
      padding: 1rem;
      text-align: center;
    }
    header h1 {
      margin: 0;
      color: #66fcf1;
    }
    nav {
      background: #45a29e;
      padding: 0.5rem;
      text-align: center;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      margin: 0 1rem;
      font-weight: bold;
    }
    nav a:hover {
      text-decoration: underline;
    }
    section {
      padding: 2rem;
      max-width: 1000px;
      margin: auto;
    }
    h2 {
      color: #66fcf1;
      margin-bottom: 1rem;
    }
    .card {
      background: #1f2833;
      padding: 1.5rem;
      border-radius: 10px;
      margin-bottom: 2rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.5);
    }
    .btn {
      background: #45a29e;
      color: #fff;
      border: none;
      padding: 0.7rem 1.2rem;
      border-radius: 5px;
      cursor: pointer;
    }
    .btn:hover {
      background: #66fcf1;
      color: #000;
    }
    footer {
      text-align: center;
      padding: 1rem;
      background: #1f2833;
      color: #aaa;
    }
    textarea, input {
      width: 100%;
      padding: 0.5rem;
      margin: 0.5rem 0;
      border-radius: 5px;
      border: none;
    }
    :root {
      --accent:#0fdba8;
      --bg:#0b1a2b;
      --panel:#13263f;
      --text:#f5f7fa;
      --muted:#bcd2e8;
      --warn:#ffb020;
      --ok:#20c997;
      --err:#ff6b6b;
    }
    body {
      margin:0;
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
    }
    #teom-outreach {
      padding: 2rem;
      background: var(--bg);
    }
    #teom-outreach h2 {
      font-size: 1.8rem;
      color: var(--accent);
      text-align: center;
      margin-bottom: 1rem;
    }
    .grid {
      display: grid;
      gap: 1rem;
      grid-template-columns: repeat(auto-fit,minmax(280px,1fr));
    }
    .card {
      background: var(--panel);
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    }
    .card h3 {
      margin-top: 0;
      font-size: 1.2rem;
      color: var(--accent);
    }
    label { display:block; font-size:0.9rem; margin-top:0.5rem; }
    input, textarea, select, button {
      width: 100%;
      padding: 0.4rem;
      margin-top: 0.25rem;
      border-radius: 0.5rem;
      border: none;
      font-size: 0.9rem;
    }
    textarea { resize: vertical; }
    button {
      background: var(--accent);
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: 0.2s;
    }
    button:hover { filter: brightness(1.1); }
    ul { padding-left:1.2rem; }
    .log-entry {
      background: #0c2238;
      padding:0.5rem;
      border-radius:0.5rem;
      margin-bottom:0.5rem;
      font-size:0.85rem;
    }
    .admin-lock {
      background: #111a28;
      padding:1rem;
      border-radius:0.75rem;
      margin-top:1rem;
    }
    .hidden { display:none; }
  </style>
</head>
<body>

  <header>
    <h1>üïäÔ∏è Wings of the Cherubim ‚Äì TEOM Outreach</h1>
    <p>"The End of Mombasa shall be turned into Light"</p>
  </header>

  <nav>
    <a href="#overview">Overview</a>
    <a href="#schedule">Schedule</a>
    <a href="#churches">Churches & Warriors</a>
    <a href="#finance">Finance</a>
    <a href="#evidence">Evidence</a>
    <a href="#admin">Admin</a>
  </nav>

  <section id="overview">
    <div class="card">
      <h2>Mission Overview</h2>
      <p>
        This hub tracks all outreach under TEOM. Our calling is to carry the Flame of Christ into 
        Mombasa through prayer, service, testimony, and light-bearing action.  
      </p>
      <p><strong>Director:</strong> Greg<br>
         <strong>President -Field Lead:</strong> Vanessa<br>
         <strong>General Secretary -Coordinator:</strong> Chris Beda</p>
    </div>
  </section>

  <!-- üî• Insert your Outreach Module here -->
  <!-- TEOM Outreach Module ‚Äì Wings of the Cherubim -->
  <!-- TEOM Outreach Module ‚Äì Wings of the Cherubim -->
<section id="teom-outreach" style="--accent:#0fdba8; --bg:#0b1a2b; --panel:#13263f; --text:#f5f7fa; --muted:#bcd2e8; --warn:#ffb020; --ok:#20c997; --err:#ff6b6b;">
  <style>
    #teom-outreach{color:var(--text);background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;padding:16px}
    #teom-outreach *{box-sizing:border-box}
    #teom-outreach h1,#teom-outreach h2,#teom-outreach h3{margin:.4rem 0;color:#ffd700}
    #teom-outreach p{margin:.35rem 0;color:var(--muted)}
    #teom-outreach .grid{display:grid;gap:12px}
    #teom-outreach .g2{grid-template-columns:repeat(2,minmax(0,1fr))}
    #teom-outreach .g3{grid-template-columns:repeat(3,minmax(0,1fr))}
    @media (max-width:900px){#teom-outreach .g3{grid-template-columns:1fr}}
    @media (max-width:720px){#teom-outreach .g2{grid-template-columns:1fr}}
    #teom-outreach .card{background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,.22)}
    #teom-outreach .btn{appearance:none;border:1px solid rgba(255,255,255,.12);background:transparent;color:var(--text);padding:.55rem .8rem;border-radius:10px;cursor:pointer}
    #teom-outreach .btn:hover{border-color:var(--accent)}
    #teom-outreach .btn.primary{background:var(--accent);color:#08131f;border-color:transparent;font-weight:600}
    #teom-outreach .btn.warn{background:var(--warn);color:#1b1203;border-color:transparent}
    #teom-outreach .btn.ok{background:var(--ok);color:#03140f;border-color:transparent}
    #teom-outreach input, #teom-outreach select, #teom-outreach textarea{width:100%;padding:.55rem .6rem;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:#0e2136;color:var(--text)}
    #teom-outreach label{font-size:.9rem;color:#dfe9f5}
    #teom-outreach .row{display:flex;gap:8px;flex-wrap:wrap}
    #teom-outreach .chip{display:inline-block;padding:.2rem .55rem;border-radius:999px;border:1px solid rgba(255,255,255,.18);color:var(--muted);margin:.2rem .25rem 0 0}
    #teom-outreach .table{width:100%;border-collapse:collapse}
    #teom-outreach .table th,#teom-outreach .table td{border-bottom:1px dashed rgba(255,255,255,.12);padding:.5rem .4rem;text-align:left}
    #teom-outreach .tag{font-size:.75rem;padding:.15rem .5rem;border-radius:8px;color:#0b1a2b;background:var(--accent);margin-left:.35rem}
    #teom-outreach .divider{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);margin:.6rem 0}
    #teom-outreach .lock{filter:grayscale(.2) drop-shadow(0 2px 8px rgba(0,0,0,.5))}
    #teom-outreach .notice{padding:.6rem .8rem;border:1px dashed rgba(255,255,255,.18);border-radius:10px;background:rgba(255,255,255,.03)}
    #teom-outreach .success{color:var(--ok)}
    #teom-outreach .error{color:#ff6b6b}
    #teom-outreach .small{font-size:.85rem;color:var(--muted)}
    #teom-outreach .right{justify-content:flex-end}
    #teom-outreach .between{justify-content:space-between}
    #teom-outreach .muted{color:var(--muted)}
    #teom-outreach .hidden{display:none !important}
  </style>

  <header class="card">
    <h1>The Great Evangelist Outreach ‚Äì Mombasa</h1>
    <p><strong>Mission:</strong> To bring the love, the light, and the salvation of Jesus Christ to all souls in Mombasa through united prayer and evangelism.</p>
    <div class="row between">
      <div>
        <span class="chip">Director: Gregory Shadt</span>
        <span class="chip">President: Vanessa Juma</span>
        <span class="chip">Secretary and Treasurer: Chris Beda</span>
      </div>
      <div class="row">
        <button class="btn" id="btnPrint">Print</button>
        <button class="btn" id="btnExport">Export Data</button>
        <label class="small" style="display:flex;align-items:center;gap:6px">
          <input type="file" id="importFile" accept="application/json"> Import Data
        </label>
      </div>
    </div>
  </header>

  <!-- Public Overview -->
  <div class="grid g3">
    <section class="card">
      <h2>Upcoming Actions <span class="tag">Schedule</span></h2>
      <ul id="scheduleList" class="small"></ul>
      <div class="divider"></div>
      <p class="muted small">Saturday market (11:00‚Äì12:00) and Sunday after-service outreach are the default anchors. Adjust below if needed.</p>
          <!-- Outreach Schedule -->
      <div class="card">
        <h3>Outreach Schedule</h3>
        <label for="outreachDate">Date</label>
        <input type="date" id="outreachDate">
        <label for="outreachTask">Task</label>
        <input type="text" id="outreachTask" placeholder="Enter task">
        <button id="btnAddTask">Add Task</button>
        <ul id="taskList"></ul>
      </div></section>

    <section class="card">
      <h2>Participating Churches <span class="tag">Prayer Warriors</span></h2>
      <table class="table" id="churchTable">
        <thead>
          <tr><th>Church</th><th>Pastor</th><th>Prayer Warriors (target 5)</th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <p class="small muted">Add churches and prayer warriors in the Admin panel.</p>
         <!-- Churches & Warriors -->
      <div class="card">
        <h3>Churches & Warriors</h3>
        <label for="churchName">Church/Warrior</label>
        <input type="text" id="churchName" placeholder="Enter name">
        <button id="btnAddChurch">Add</button>
        <ul id="churchList"></ul>
      </div>
      </section>

    <section class="card">
      <h2>Evidence Log <span class="tag">Photos and Links</span></h2>
      <div id="evidenceList" class="grid"></div>
      <p class="small muted">Add testimonies, links, and media in the Admin panel.</p>
         <!-- Evidence Log -->
      <div class="card">
        <h3>Evidence Log</h3>
        <label for="evidenceText">Record Evidence</label>
        <textarea id="evidenceText" rows="3" placeholder="Enter evidence"></textarea>
        <button id="btnSaveEvidence">Save</button>
        <div id="evidenceLog"></div>
      </div>
    </section>
  </div>

  <!-- Admin Lock -->
  <section class="card">
    <div class="row between">
      <h2 class="row" style="align-items:center;gap:8px">Administrative Controls <img class="lock" alt="lock" width="18" height="18" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='%23ffd700'><path d='M12 1a5 5 0 00-5 5v3H5a2 2 0 00-2 2v8a2 2 0 002 2h14a2 2 0 002-2v-8a2 2 0 00-2-2h-2V6a5 5 0 00-5-5zm-3 8V6a3 3 0 016 0v3H9z'/></svg>"></h2>
      <div class="row">
        <input type="password" id="adminKey" placeholder="Enter secret key to unlock">
        <button class="btn primary" id="btnUnlock">Unlock</button>
        <button class="btn warn hidden" id="btnLock">Lock</button>
      </div>
    </div>
    <p id="adminNote" class="notice small">Administrative controls are hidden until the correct secret key is entered. The key is stored only in this browser (localStorage) for your convenience. Clear it any time with ‚ÄúLock‚Äù.</p>

    <!-- Admin Panels -->
    <div id="adminPanels" class="grid g2 hidden">

      <!-- Schedule Manager -->
      <div class="card">
        <h3>Schedule Manager</h3>
        <div class="grid g2">
          <div>
            <label>Day</label>
            <select id="schDay">
              <option>Saturday</option>
              <option>Sunday</option>
              <option>Monday</option>
              <option>Tuesday</option>
              <option>Wednesday</option>
              <option>Thursday</option>
              <option>Friday</option>
            </select>
          </div>
          <div>
            <label>Time Range</label>
            <input id="schTime" placeholder="e.g., 11:00‚Äì12:00">
          </div>
        </div>
        <label>Location</label>
        <input id="schLocation" placeholder="e.g., Kengeleni Market">
        <label>Focus</label>
        <input id="schFocus" placeholder="e.g., public prayer, preaching, distribution">
        <div class="row right" style="margin-top:8px">
          <button class="btn ok" id="btnAddSchedule">Add Action</button>
        </div>
        <div class="divider"></div>
        <ul id="adminSchedule" class="small"></ul>
      </div>
      <!-- Outreach Schedule -->
      <div class="card">
        <h3>Outreach Schedule</h3>
        <label for="outreachDate">Date</label>
        <input type="date" id="outreachDate">
        <label for="outreachTask">Task</label>
        <input type="text" id="outreachTask" placeholder="Enter task">
        <button id="btnAddTask">Add Task</button>
        <ul id="taskList"></ul>
      </div>
      <!-- Church and Prayer Warriors -->
      <div class="card">
        <h3>Church and Prayer Warriors</h3>
        <label>Church Name</label>
        <input id="chName" placeholder="e.g., Gospel Light Church">
        <label>Pastor Name</label>
        <input id="chPastor" placeholder="e.g., Pastor John">
        <label>Prayer Warriors (comma-separated, target five)</label>
        <input id="chWarriors" placeholder="e.g., Mary, Peter, Joy, Kevin, Ruth">
        <div class="row right" style="margin-top:8px">
          <button class="btn ok" id="btnAddChurch">Add Church</button>
        </div>
        <div class="divider"></div>
        <ul id="adminChurchList" class="small"></ul>
      </div>

      <!-- Financial Allocation -->
      <div class="card">
        <h3>Financial Allocation</h3>
        <label>Total Funds Received (currency as sent)</label>
        <input id="faTotal" type="number" min="0" step="0.01" placeholder="e.g., 200">
        <div class="grid g3">
          <div>
            <label>Shirts and Hats (%)</label>
            <input id="faApparel" type="number" min="0" max="100" value="30">
          </div>
          <div>
            <label>Food and Meals (%)</label>
            <input id="faFood" type="number" min="0" max="100" value="40">
          </div>
          <div>
            <label>Logistics and Transport (%)</label>
            <input id="faLog" type="number" min="0" max="100" value="30">
          </div>
        </div>
        <div class="row right" style="margin-top:8px">
          <button class="btn ok" id="btnCalc">Calculate Allocation</button>
        </div>
        <p id="faResult" class="small muted"></p>
      </div>

      <!-- Evidence and Testimonies -->
      <div class="card">
        <h3>Evidence and Testimonies</h3>
        <label>Title</label>
        <input id="evTitle" placeholder="e.g., Prayer at Kengeleni">
        <label>Media Link (photo, video, or post)</label>
        <input id="evLink" placeholder="https://">
        <label>Notes or Testimony</label>
        <textarea id="evNotes" rows="3" placeholder="What happened? Who was touched?"></textarea>
        <div class="row right" style="margin-top:8px">
          <button class="btn ok" id="btnAddEvidence">Add Evidence</button>
        </div>
        <div class="divider"></div>
        <ul id="adminEvidence" class="small"></ul>
      </div>

    </div>
  </section>

  <footer class="row between" style="margin-top:10px">
    <div class="small muted">Motto: ‚ÄúLight Up Mombasa with Christ!‚Äù ‚Ä¢ Scriptural anchor: 1 Timothy 2:3‚Äì4</div>
    <div class="small muted">Module: TEOM Outreach ‚Ä¢ Client-side data with optional JSON export</div>
  </footer>

  <script>
    (function(){
      const storeKey = 'teom_outreach_store_v1';
      const adminKeyStore = 'teom_admin_key_saved';
      const $ = (sel,root=document)=>root.querySelector(sel);
      const $$ = (sel,root=document)=>Array.from(root.querySelectorAll(sel));

      const initial = {
        schedule: [
          { day:'Saturday', time:'11:00‚Äì12:00', location:'Kengeleni Market', focus:'Public prayer and evangelism' },
          { day:'Sunday', time:'After service (30 minutes)', location:'Local partner church', focus:'Prayer and testimonies' }
        ],
        churches: [],
        evidence: []
      };

      let state = load();

      // Renderers
      function renderPublic(){
        // Schedule top
        const sl = $('#scheduleList'); sl.innerHTML='';
        state.schedule.forEach((s,i)=>{
          const li = document.createElement('li');
          li.innerHTML = `<strong>${s.day}</strong> ‚Äî ${s.time} ‚Ä¢ <span class="muted">${s.location}</span><br><span class="small muted">${s.focus||''}</span>`;
          sl.appendChild(li);
        });

        // Churches table
        const tbody = $('#churchTable tbody'); tbody.innerHTML='';
        state.churches.forEach(ch=>{
          const tr=document.createElement('tr');
          const warriors = (ch.warriors||[]);
          tr.innerHTML = `
            <td>${escapeHtml(ch.name)}</td>
            <td>${escapeHtml(ch.pastor||'')}</td>
            <td>${warriors.length} / 5 ${warriors.length? warriors.map(w=>`<span class="chip">${escapeHtml(w)}</span>`).join(''):''}</td>
          `;
          tbody.appendChild(tr);
        });

        // Evidence list
        const ev = $('#evidenceList'); ev.innerHTML='';
        if(state.evidence.length===0){
          const p=document.createElement('p'); p.className='small muted'; p.textContent='No evidence added yet.';
          ev.appendChild(p);
        } else {
          state.evidence.slice().reverse().forEach(e=>{
            const card=document.createElement('div'); card.className='card';
            card.innerHTML = `
              <strong>${escapeHtml(e.title||'Untitled')}</strong>
              ${e.link?` ‚Ä¢ <a href="${escapeAttr(e.link)}" target="_blank" rel="noopener" style="color:var(--accent)">Open</a>`:''}
              <div class="small muted" style="margin-top:.3rem">${escapeHtml(e.notes||'')}</div>
            `;
            ev.appendChild(card);
          });
        }
      }

      function renderAdmin(){
        // schedule in admin
        const ul = $('#adminSchedule'); ul.innerHTML='';
        state.schedule.forEach((s,idx)=>{
          const li=document.createElement('li');
          li.innerHTML = `<strong>${s.day}</strong> ‚Äî ${s.time} ‚Ä¢ <span class="muted">${s.location}</span> ‚Äî <span class="small muted">${s.focus||''}</span>
            <button class="btn small" data-del-schedule="${idx}" style="margin-left:.5rem">Remove</button>`;
          ul.appendChild(li);
        });
        // churches admin list
        const cl = $('#adminChurchList'); cl.innerHTML='';
        state.churches.forEach((c,idx)=>{
          const li=document.createElement('li');
          li.innerHTML = `<strong>${escapeHtml(c.name)}</strong> ‚Äî ${escapeHtml(c.pastor||'')}
            <div class="small muted">Prayer warriors: ${(c.warriors||[]).map(w=>`<span class="chip">${escapeHtml(w)}</span>`).join('') || 'None yet'}</div>
            <div class="row" style="margin-top:.3rem">
              <input placeholder="Add warrior name" data-warrior-input="${idx}">
              <button class="btn small ok" data-add-warrior="${idx}">Add</button>
              <button class="btn small" data-del-church="${idx}" style="margin-left:auto">Remove Church</button>
            </div>`;
          cl.appendChild(li);
        });
        // evidence admin list
        const el = $('#adminEvidence'); el.innerHTML='';
        state.evidence.forEach((e,idx)=>{
          const li=document.createElement('li');
          li.innerHTML = `<strong>${escapeHtml(e.title||'Untitled')}</strong>
            ${e.link?` ‚Ä¢ <a href="${escapeAttr(e.link)}" target="_blank" rel="noopener" style="color:var(--accent)">Open</a>`:''}
            <span class="small muted"> ‚Äî ${escapeHtml((e.notes||'').slice(0,80))}${(e.notes||'').length>80?'‚Ä¶':''}</span>
            <button class="btn small" data-del-evidence="${idx}" style="margin-left:.5rem">Remove</button>`;
          el.appendChild(li);
        });
      }

      // Events
      $('#btnPrint').addEventListener('click',()=>window.print());
      $('#btnExport').addEventListener('click',()=>downloadJSON(state,'teom-outreach-data.json'));
      $('#importFile').addEventListener('change',onImport);

      $('#btnUnlock').addEventListener('click',()=>{
        const key = $('#adminKey').value.trim();
        if(!key){return alert('Please enter the secret key.');}
        // Save key locally so you do not need to retype
        localStorage.setItem(adminKeyStore,key);
        toggleAdmin(true);
      });
      $('#btnLock').addEventListener('click',()=>{
        localStorage.removeItem(adminKeyStore);
        toggleAdmin(false);
      });

      // schedule add
      $('#btnAddSchedule').addEventListener('click',()=>{
        const item = {
          day: $('#schDay').value.trim(),
          time: $('#schTime').value.trim() || '11:00‚Äì12:00',
          location: $('#schLocation').value.trim() || 'To be announced',
          focus: $('#schFocus').value.trim() || ''
        };
        state.schedule.push(item);
        save(); renderPublic(); renderAdmin();
        $('#schTime').value=''; $('#schLocation').value=''; $('#schFocus').value='';
      });

      // financial allocation
      $('#btnCalc').addEventListener('click',()=>{
        const total = parseFloat($('#faTotal').value||'0');
        const apparel = parseFloat($('#faApparel').value||'0');
        const food = parseFloat($('#faFood').value||'0');
        const logi = parseFloat($('#faLog').value||'0');
        const sum = apparel+food+logi;
        if(sum!==100){return $('#faResult').innerHTML = `<span class="error">Percentages must total 100 (current total ${sum}).</span>`}
        const a = (total*apparel/100).toFixed(2);
        const f = (total*food/100).toFixed(2);
        const l = (total*logi/100).toFixed(2);
        $('#faResult').innerHTML = `<span class="success">Allocation ‚Üí Shirts and Hats: ${a} ‚Ä¢ Food and Meals: ${f} ‚Ä¢ Logistics and Transport: ${l}</span>`;
      });

      // church add
      $('#btnAddChurch').addEventListener('click',()=>{
        const name=$('#chName').value.trim(); if(!name) return alert('Please enter the church name.');
        const pastor=$('#chPastor').value.trim();
        const warriors=($('#chWarriors').value||'').split(',').map(s=>s.trim()).filter(Boolean);
        state.churches.push({name, pastor, warriors});
        save(); renderPublic(); renderAdmin();
        $('#chName').value=''; $('#chPastor').value=''; $('#chWarriors').value='';
      });

      // evidence add
      $('#btnAddEvidence').addEventListener('click',()=>{
        const title=$('#evTitle').value.trim(); if(!title) return alert('Please enter a title.');
        const link=$('#evLink').value.trim();
        const notes=$('#evNotes').value.trim();
        state.evidence.push({title, link, notes, at:new Date().toISOString()});
        save(); renderPublic(); renderAdmin();
        $('#evTitle').value=''; $('#evLink').value=''; $('#evNotes').value='';
      });

      // delegated admin actions
      document.addEventListener('click',(e)=>{
        const ds = e.target.dataset || {};
        if(ds.delSchedule!==undefined){
          const idx = +ds.delSchedule; state.schedule.splice(idx,1); save(); renderPublic(); renderAdmin();
        }
        if(ds.delChurch!==undefined){
          const idx = +ds.delChurch; state.churches.splice(idx,1); save(); renderPublic(); renderAdmin();
        }
        if(ds.addWarrior!==undefined){
          const idx = +ds.addWarrior;
          const input = document.querySelector(`[data-warrior-input="${idx}"]`);
          const name = input.value.trim(); if(!name) return;
          state.churches[idx].warriors = state.churches[idx].warriors||[];
          state.churches[idx].warriors.push(name);
          input.value=''; save(); renderPublic(); renderAdmin();
        }
        if(ds.delEvidence!==undefined){
          const idx = +ds.delEvidence; state.evidence.splice(idx,1); save(); renderPublic(); renderAdmin();
        }
      });

      // Admin toggle based on saved key
      const savedKey = localStorage.getItem(adminKeyStore);
      if(savedKey){ $('#adminKey').value=savedKey; toggleAdmin(true); }

      // Initial render
      renderPublic(); renderAdmin();

      // Helpers
      function toggleAdmin(on){
        $('#adminPanels').classList.toggle('hidden',!on);
        $('#btnLock').classList.toggle('hidden',!on);
        $('#btnUnlock').classList.toggle('hidden',on);
        $('#adminNote').textContent = on
          ? 'Administrative controls are unlocked. Remember to lock when you finish.'
          : 'Administrative controls are hidden until the correct secret key is entered. The key is stored only in this browser (localStorage).';
      }
      function load(){
        try{
          const raw = localStorage.getItem(storeKey);
          if(!raw){ localStorage.setItem(storeKey, JSON.stringify(initial)); return JSON.parse(JSON.stringify(initial)); }
          const data = JSON.parse(raw);
          // gentle migration
          if(!data.schedule) data.schedule = initial.schedule.slice();
          if(!data.churches) data.churches = [];
          if(!data.evidence) data.evidence = [];
          return data;
        }catch(e){ return JSON.parse(JSON.stringify(initial)); }
      }
      function save(){ localStorage.setItem(storeKey, JSON.stringify(state)); }
      function downloadJSON(obj, filename){
        const blob = new Blob([JSON.stringify(obj,null,2)], {type:'application/json'});
        const url = URL.createObjectURL(blob);
        const a=document.createElement('a'); a.href=url; a.download=filename; a.click();
        setTimeout(()=>URL.revokeObjectURL(url), 500);
      }
      function onImport(evt){
        const file=evt.target.files[0]; if(!file) return;
        const reader=new FileReader();
        reader.onload = () => {
          try{
            const data = JSON.parse(reader.result);
            if(!data || typeof data!=='object') throw new Error('Invalid JSON');
            state = { schedule:data.schedule||[], churches:data.churches||[], evidence:data.evidence||[] };
            save(); renderPublic(); renderAdmin();
            alert('Data imported successfully.');
          }catch(err){ alert('Import failed: ' + err.message); }
        };
        reader.readAsText(file);
        evt.target.value='';
      }
      function escapeHtml(s){return (s||'').replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]))}
      function escapeAttr(s){return (s||'').replace(/"/g,'&quot;')}
    })();
  </script>
</section>
  <section id="teom-outreach" style="--accent:#0fdba8; --bg:#0b1a2b; --panel:#13263f; --text:#f5f7fa; --muted:#bcd2e8; --warn:#ffb020; --ok:#20c997; --err:#ff6b6b;">
